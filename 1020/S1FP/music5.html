<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Blue Tape - Song Details</title>

  <link rel="stylesheet" href="song1.css" />

  <!-- Optional font -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Audiowide&display=swap" rel="stylesheet"/>
</head>
<body>

    <!-- Add the back button here -->
    <a href="library.html" class="back-button">
        <img src="Assets/Image/Back.png" alt="Go Back">
    </a>

  <div id="paper">
    <!-- Cassette assembly -->
    <div class="tape-assembly">
      <!-- Transparent clickable rectangle (rounded) -->
      <div id="play-button" class="tape-hitbox" title="Click to play/pause"></div>

      <!-- Visuals -->
      <img src="Assets/Image/LeftCircle.png" alt="Left reel" class="tape-circle left-circle" />
      <img src="Assets/Image/RightCircle.png" alt="Right reel" class="tape-circle right-circle" />
      <img src="Assets/Image/Tape1.png" alt="Cassette Tape" class="tape-image-main" />
    </div>

    <!-- Tiny YouTube player (audio only) -->
    <div id="player" aria-hidden="true"></div>

    <div class="text-content">
      <h1 class="song-title">Faded Frequency</h1>
      <h2 class="artist-name">Synthwave Dreamer</h2>
      <div class="lyrics">
        <p>
          (Verse 1)<br>
          The city sleeps under a neon glow<br>
          Static on the radio, nowhere to go<br>
          Another night, another empty street<br>
          Just the rhythm of my own two feet<br><br>

          (Chorus)<br>
          And we're chasing the midnight sun<br>
          Yeah, we're racing but never done<br>
          Living in a memory<br>
          Just a faded frequency<br><br>

          (Verse 2)<br>
          I see your face in every passing car<br>
          A distant echo, a fading star<br>
          The message sent, but never received<br>
          In a digital world, what's to be believed?<br><br>

          (Chorus)<br>
          And we're chasing the midnight sun<br>
          Yeah, we're racing but never done<br>
          Living in a memory<br>
          Just a faded frequency<br><br>

          (Bridge)<br>
          The tape is worn, the sound is thin<br>
          Let the story just begin<br>
          Rewind it back, and press play now<br>
          We'll figure it out somehow<br><br>

          (Outro)<br>
          Figure it out somehow...<br>
          A faded frequency...<br>
          Just you and me...<br>
          In the static, we are free...
        </p>
      </div>
    </div>
  </div>

  <!-- YouTube IFrame API -->
  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    var player = null;
    var playerReady = false;
    var pendingPlay = false;

    // Called by the API when it finishes loading
    function onYouTubeIframeAPIReady() {
      // We create the player lazily on first click for solid user-gesture playback.
    }

    function createPlayer() {
      if (player) return;
      player = new YT.Player('player', {
        height: '1',
        width: '1',
        videoId: 'sPLqsLsooJY',
        playerVars: { playsinline: 1, controls: 0, rel: 0 },
        events: {
          onReady: function () {
            playerReady = true;
            // Allow autoplay on the created iframe
            try {
              var iframe = player.getIframe();
              iframe.setAttribute('allow', 'autoplay; encrypted-media');
            } catch (e) {}

            if (pendingPlay) {
              pendingPlay = false;
              togglePlay();
            }
          },
          onStateChange: onPlayerStateChange
        }
      });
    }

    function onPlayerStateChange(event) {
      // Toggle reel spinning classes based on play/pause
      const left = document.querySelector('.left-circle');
      const right = document.querySelector('.right-circle');

      if (event.data === YT.PlayerState.PLAYING) {
        left.classList.remove('paused');
        right.classList.remove('paused');
        left.classList.add('spinning');
        right.classList.add('spinning');
      } else {
        left.classList.remove('spinning');
        right.classList.remove('spinning');
        left.classList.add('paused');
        right.classList.add('paused');
      }
    }

    function togglePlay() {
      if (!playerReady) {
        pendingPlay = true;
        return;
      }
      var state = player.getPlayerState(); // -1 unstarted, 0 ended, 1 playing, 2 paused, 3 buffering, 5 cued
      if (state === YT.PlayerState.PLAYING) {
        player.pauseVideo();
      } else {
        player.playVideo(); // user gesture â†’ allowed
      }
    }

    document.addEventListener('DOMContentLoaded', function () {
      var btn = document.getElementById('play-button');

      btn.addEventListener('click', function () {
        // If API not ready yet, try shortly and mark intent
        if (typeof YT === 'undefined' || typeof YT.Player === 'undefined') {
          pendingPlay = true;
          setTimeout(createPlayer, 150);
          return;
        }
        // Create the player on first click
        if (!player) {
          pendingPlay = true;
          createPlayer();
          return;
        }
        // Otherwise toggle
        togglePlay();
      });
    });
  </script>
</body>
</html>
